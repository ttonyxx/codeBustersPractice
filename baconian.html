<!DOCTYPE html>
<html lang="en">

	<head>
		
	    <meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta http-equiv="x-ua-compatible" content="ie=edge">

		<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
		<link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.light_green-lime.min.css" />
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">
		<script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
		
		<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
		<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
		<link rel="manifest" href="site.webmanifest">
		<link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
		<meta name="msapplication-TileColor" content="#00a300">
		<meta name="theme-color" content="#ffffff">
		
		  <!-- Add to homescreen for Chrome on Android -->
		  <meta name="mobile-web-app-capable" content="yes">
		  <meta name="application-name" content=“Code Busters“>
		  <link rel="icon" sizes="192x192" href="android-chrome-192x192.png">

		  <!-- Add to homescreen for Safari on iOS -->
		  <meta name="apple-mobile-web-app-capable" content="yes">
		  <meta name="apple-mobile-web-app-status-bar-style" content="black">
		  <meta name="apple-mobile-web-app-title" content="Code Busters">
		  <link rel="apple-touch-icon" href="apple-touch-icon.png">

		<title>Code Busters</title>

		<!-- Uses a transparent header that draws on top of the layout's background -->
		<style>
		.demo-layout-transparent {
		  background: url('../assets/demos/transparent.jpg') center / cover;
		}
		.demo-layout-transparent .mdl-layout__header,
		.demo-layout-transparent .mdl-layout__drawer-button {
		  /* This background is dark, so we set text to white. Use 87% black instead if
		     your background is light. */
		  color: white;
		}

		.green-gradient {
			background: #56ab2f;  /* fallback for old browsers */
			background: -webkit-linear-gradient(to right, #a8e063, #56ab2f);  /* Chrome 10-25, Safari 5.1-6 */
			background: linear-gradient(to right, #a8e063, #56ab2f); /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
		}

		.box {
			opacity: 0.5;
			width: 80vh;
			height: 50vh;
			min-width: 60px;
			float: left;
			background-color: white;
			border-radius: 40px;
			margin: 0 auto;
			display: flex;
			align-items: center;
			justify-content: center;
		}

		#morsecode {
			font-size: 15vh;
		}

		p {
			font-size: 10vh;
		}

		.container {
			margin-top: 10%;
			display: flex;
			align-items: center;
			justify-content: center;
		}

		.page-content {
			text-align: center;
		}

		#correct {
			position: absolute;
			left: 50%;
			margin-left: -32vh;
			top: 7vh;
			font-size: 20vh;
			z-index: -1;
			color: green;
		}

		#timer {
			margin-top: 3vh;
			color: rgb(61, 130, 51);
			display: none;
		}

		#result {
			position: absolute;
			background-color: black;
			opacity: 0.7;
			width: 40%;
			height: 35vh;
			border-radius: 5vh;
			top: 26vh;
			left: 30%;
			display: none;
		}

		</style>

	</head>

	<body onload="start()">

		<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
			<header class="mdl-layout__header mdl-layout__header--waterfall green-gradient">
				<div class="mdl-layout__header-row">
				  <!-- Title -->
				  <span class="mdl-layout-title">Code Busters Practice</span>
				  <!-- Add spacer, to align navigation to the right -->
				  <div class="mdl-layout-spacer"></div>
				  <!-- Navigation. We hide it in small screens. -->
				  <nav class="mdl-navigation mdl-layout--large-screen-only">
					<a class="mdl-navigation__link is-active" href="index.html">Number - Letter</a>
					<a class="mdl-navigation__link" href="vigenere.html">Vigenère</a>
					<a class="mdl-navigation__link" href="porta.html">Porta</a>
					<a class="mdl-navigation__link" href="morse.html">Morse</a>
                    <a class="mdl-navigation__link" href="baconian.html">Baconian</a>

					<a class="mdl-navigation__link" href=""><label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="switch-1">
					  <input type="checkbox" id="switch-1" class="mdl-switch__input" data-checked="1" checked>
					  <span class="mdl-switch__label"></span>
					</label></a>
				  </nav>
				</div>
			  </header>
			  <div class="mdl-layout__drawer">
				<span class="mdl-layout-title">Code Busters</span>
				<nav class="mdl-navigation">
					<a class="mdl-navigation__link" href="index.html">Number - Letter</a>
					<a class="mdl-navigation__link" href="vigenere.html">Vigenère</a>
					<a class="mdl-navigation__link" href="porta.html">Porta</a>
					<a class="mdl-navigation__link" href="morse.html">Morse</a>
                    <a class="mdl-navigation__link" href="baconian.html">Baconian</a>

					
				</nav>
			  </div>
		  <main class="mdl-layout__content green-gradient" id="content">
		    <div class="page-content">

		    	<p id="correct" style="display: none">Correct</p>

		    	<div class="container">
			    	<div class="box"><p id="morsecode"></p></div>
		    	</div>

		    	<center><div style="width: 28%; margin-top: 3vh" id="slider-option">
					<input class="mdl-slider mdl-js-slider" type="range" id="response" min="0" max="25" value="0" step="1">
					<br>
					<p id="response-text" style="font-size: 20vh; margin-top: 5vh;">A</p>
				</div></center>

				<center><div style="width: 28%; margin-top: 3vh; display: none;" id="input-option">
					<form action="#">
					  <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
					    <input class="mdl-textfield__input" type="text" autocomplete="off" id="response-input">
					    <label class="mdl-textfield__label" for="sample3">Answer</label>
					  </div>
					</form>
					<br>
					<!--<button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">GO</button>-->
				</div></center>

				<center>
					<p id="timer">0.00</p>
				</center>

				<div id="result">
					<p id="result-text" style="color: white; margin-top: 3vh; font-size: 5vh; line-height: 7vh;">Score: 0/50<br>Final Time: 0.00s<br>Time per Question: 0.00s</p>
					<!-- Accent-colored raised button with ripple -->
					<button id="restart" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">
					  Restart
					</button>
				</div>
		    	
		    </div>


		  </main>
		</div>

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<script src="timer.js"></script>
		<script type="text/javascript">

			var randInt;
			var first = true;
			var problemsFinished = 0;
			var problemsCorrect = 0;
			var baconArray = ["AAAAA", "AAAAB", "AAABA", "AAABB", "AABAA", "AABAB", "AABBA", "AABBB", "ABAAA (1)", "ABAAA (2)", "ABAAB", "ABABA", "ABABB", "ABBAA", "ABBAB", "ABBBA", "ABBBB", "BAAAA", "BAAAB", "BAABA", "BAABB (1)","BAABB (2)", "BABAA", "BABAB", "BABBA", "BABBB"];
			var alphabet = ["a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z"];

			function start() {
				$('#input-option').show();
				$('#slider-option').hide();
				reset();
				//alert(localStorage.mode);
				/*
				if(localStorage.mode) {
					$('#switch-1').data('checked', localStorage.mode);
					$('#switch-1').trigger("change");
				}*/

			}

			function reset() {
				randInt = Math.floor(Math.random() * 26);
				$('#morsecode').html(baconArray[randInt]);
				animateCSS('#morsecode', 'bounceIn');
			}

			$('#response-input').change(function() {

				if(alphabet[randInt] == $('#response-input').val().toLowerCase()) {
					$('#correct').html("Correct");
					$('.box').css("background-color", "white");
					$('.box').css("opacity", "0.5");
				  	correct();
				  	problemsCorrect++;
				} else {
					$('#correct').html("Wrong");
					$('.box').css("background-color", "red");
					$('.box').css("opacity", "0.7");
					showCorrect();
				}
					console.log(alphabet[randInt] + " " + $('#response-input').val().toLowerCase());
				$('#response-input').val("");
				checkFirst();

			});

			$('#response').change(function() {

				animateSpeed('#response-text', 'fadeOutUp', 'faster', () => animateSpeed('#response-text', 'fadeInDown', 'faster'));
				$('#response-text').html(String.fromCharCode(parseInt($('#response').val())+65));
				if(randInt == parseInt($('#response').val())) {
					$('#correct').html("Correct");
				  	problemsCorrect++;
				  	correct();
				}
				checkFirst();
				
			});

			$('#restart').click(function() {
				animateCSS('#result', 'fadeOutUp', () => $('#result').hide());
				if(localStorage.mode == "0") {
					$('#response').show();
					animateCSS('#response', 'fadeIn');
				} else {
					$('#response-input').show();
					animateCSS('#response-input', 'fadeIn');
				}
			});

			function checkFirst() {
				if(first) {
					$('#timer').show();
					restart();
					animateSpeed('#timer', 'fadeIn', 'slow');
					startTimer();
					first = false;
					if(problemsCorrect != 1) {
						problemsCorrect = 0;
					}
					problemsFinished = 0;
				}
				problemsFinished++;
				if(problemsFinished == 50) {
					stop();
					animateSpeed('#timer', 'fadeOut', 'slow', () => $('#timer').hide());
					first = true;
					$('#result-text').html("Score: " + problemsCorrect + "/50<br>Final Time: " + $('#timer').html() + "s<br>Time per Question: " + Math.round(timeToNum($('#timer').html())*1000)/50000 + "s");
					$('#result').show();
					animateCSS('#result', 'fadeInDown');
					$('#response-input').hide();
					$('#response').hide();
				}
			}

			function correct() {
				showCorrect();
				reset();
			}

			function showCorrect() {
				$('#correct').show();
			  	animateCSS('#correct', 'bounceIn', () => {
			  		animateCSS('#correct', 'bounceOut')
			  		$('#correct').hide();
			  	});
			}

			function timeToNum(timeText) {
				var time = timeText.split(":");
				var timeNum = 0;
				var i;
				var count = 1;
				timeNum += parseFloat(time[time.length-1]) * 0.01;
				timeNum += parseFloat(time[time.length-2]);
				if(time.length == 3) {
					timeNum += parseFloat(time[time.length-3]) * 60;
				}
				return Math.round(timeNum*100)/100;
			}

			function animateCSS(element, animationName, callback) {
			    const node = document.querySelector(element)
			    node.classList.add('animated', animationName)

			    function handleAnimationEnd() {
			        node.classList.remove('animated', animationName)
			        node.removeEventListener('animationend', handleAnimationEnd)

			        if (typeof callback === 'function') callback()
			    }

			    node.addEventListener('animationend', handleAnimationEnd)
			}

			function animateSpeed(element, animationName, speed, callback) {
			    const node = document.querySelector(element)
			    node.classList.add('animated', animationName)
			    node.classList.add(speed);

			    function handleAnimationEnd() {
			        node.classList.remove('animated', animationName)
			    	node.classList.remove(speed);
			        node.removeEventListener('animationend', handleAnimationEnd)

			        if (typeof callback === 'function') callback()
			    }

			    node.addEventListener('animationend', handleAnimationEnd)
			}

		</script>

	</body>

</html>

